<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>함께줍줍(Hamkae) API 명세서</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        h2 {
            color: #2c3e50;
            font-size: 1.8rem;
            margin: 30px 0 20px 0;
            padding: 15px 20px;
            background: linear-gradient(90deg, #f8f9fa 0%, #e9ecef 100%);
            border-left: 5px solid #4facfe;
            border-radius: 0 10px 10px 0;
        }

        h3 {
            color: #34495e;
            font-size: 1.4rem;
            margin: 25px 0 15px 0;
            padding: 10px 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #00f2fe;
        }

        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border: 1px solid #e9ecef;
        }

        .endpoint {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            border: 1px solid #dee2e6;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .method {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            text-transform: uppercase;
            margin-bottom: 10px;
        }

        .method.post { background: #28a745; color: white; }
        .method.get { background: #007bff; color: white; }
        .method.delete { background: #dc3545; color: white; }

        .url {
            font-family: 'Courier New', monospace;
            background: #2d3748;
            color: #e2e8f0;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9rem;
            margin: 10px 0;
            display: inline-block;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .code-block pre {
            margin: 0;
        }

        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .highlight strong {
            color: #856404;
        }

        ul {
            margin: 15px 0;
            padding-left: 25px;
        }

        li {
            margin: 8px 0;
            line-height: 1.5;
        }

        code {
            background: #f1f3f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #d73a49;
        }

        .data-structure {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .data-structure h2 {
            color: white;
            background: transparent;
            border-left: none;
            padding: 0 0 15px 0;
        }

        .data-structure ul {
            list-style: none;
            padding-left: 0;
        }

        .data-structure li {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #00f2fe;
        }

        .constraints {
            background: #fff5f5;
            border: 1px solid #fed7d7;
            padding: 20px;
            border-radius: 10px;
            margin: 30px 0;
        }

        .constraints h2 {
            color: #c53030;
            background: transparent;
            border-left: none;
            padding: 0 0 15px 0;
        }

        .footer {
            text-align: center;
            padding: 30px;
            background: #f8f9fa;
            color: #6c757d;
            border-top: 1px solid #dee2e6;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .section {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🗑️ 함께줍줍(Hamkae) API 명세서</h1>
            <p>프론트엔드 개발자를 위한 핵심 API 가이드</p>
        </div>

        <div class="content">
            <div class="section">
                <h2>📋 기본 정보</h2>
                <ul>
                    <li><strong>Base URL:</strong> <code>http://localhost:8080</code></li>
                    <li><strong>인증:</strong> 필요한 API에 <code>Authorization: Bearer {JWT}</code></li>
                    <li><strong>공통 응답:</strong> <code>ApiResponse&lt;T&gt;</code> → <code>success:boolean</code>, <code>message:string</code>, <code>data:T|null</code></li>
                </ul>
            </div>

            <div class="section">
                <h2>🔐 1) 인증</h2>
                
                <div class="endpoint">
                    <span class="method post">POST</span>
                    <div class="url">/auth/register</div>
                    <ul>
                        <li><strong>Body (JSON):</strong>
                            <div class="code-block">
<pre>{
  "name": "홍길동",
  "username": "hong123",
  "password": "password123"
}</pre>
                            </div>
                        </li>
                        <li><strong>성공 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "회원가입 성공",
  "data": {
    "user_id": 1
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (400) - 중복 사용자명:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "이미 존재하는 사용자명입니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (400) - 유효성 검증 실패:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "입력값이 올바르지 않습니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>요청 제약사항:</strong>
                            <ul>
                                <li><code>name</code>: 2~20자 한글/영문</li>
                                <li><code>username</code>: 4~20자 영문/숫자/언더스코어</li>
                                <li><code>password</code>: 8~20자 영문/숫자/특수문자</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="endpoint">
                    <span class="method post">POST</span>
                    <div class="url">/auth/login</div>
                    <ul>
                        <li><strong>Body (JSON):</strong>
                            <div class="code-block">
<pre>{
  "username": "hong123",
  "password": "password123"
}</pre>
                            </div>
                        </li>
                        <li><strong>성공 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "로그인 성공",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "name": "홍길동",
      "username": "hong123",
      "points": 0
    }
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (401) - 잘못된 비밀번호:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "비밀번호가 일치하지 않습니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (404) - 존재하지 않는 사용자:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "존재하지 않는 사용자명입니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>JWT 토큰 정보:</strong>
                            <ul>
                                <li><strong>유효기간:</strong> 24시간</li>
                                <li><strong>사용법:</strong> <code>Authorization: Bearer {JWT}</code></li>
                                <li><strong>갱신:</strong> 재로그인 필요</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>📍 2) 마커 관리</h2>
                
                <div class="endpoint">
                    <span class="method post">POST</span>
                    <div class="url">/markers (사진 포함 등록)</div>
                    <ul>
                        <li><strong>Header:</strong> <code>Authorization: Bearer {JWT}</code></li>
                        <li><strong>Body (form-data):</strong>
                            <ul>
                                <li><code>lat: string</code> - 위도 (예: "37.5665")</li>
                                <li><code>lng: string</code> - 경도 (예: "126.9780")</li>
                                <li><code>description: string</code> - 마커 설명 (1~200자)</li>
                                <li><code>images: file[]</code> - 사진 파일들 (선택사항, 최대 5장)</li>
                            </ul>
                        </li>
                        <li><strong>성공 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "마커 등록 완료",
  "data": {
    "marker_id": 10,
    "uploaded_images": [
      "/images/2025/08/18/uuid1.jpg",
      "/images/2025/08/18/uuid2.jpg"
    ],
    "image_count": 2,
    "created_at": "2025-08-18T10:12:00"
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (400) - 유효성 검증 실패:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "입력값이 올바르지 않습니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (401) - 인증 실패:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "인증이 필요합니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>요청 제약사항:</strong>
                            <ul>
                                <li><strong>위도/경도:</strong> 유효한 GPS 좌표값</li>
                                <li><strong>설명:</strong> 1~200자 한글/영문/숫자</li>
                                <li><strong>사진:</strong> jpg/jpeg/png, 100KB~10MB, 최대 5장</li>
                                <li><strong>사진 해상도:</strong> 640x480 ~ 4096x4096</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="endpoint">
                    <span class="method get">GET</span>
                    <div class="url">/markers (활성 마커 목록)</div>
                    <ul>
                        <li><strong>Query Parameters (선택사항):</strong>
                            <ul>
                                <li><code>status</code> - 마커 상태 필터 (ACTIVE, CLEANED, REMOVED)</li>
                                <li><code>page</code> - 페이지 번호 (기본값: 0)</li>
                                <li><code>size</code> - 페이지 크기 (기본값: 20, 최대: 100)</li>
                            </ul>
                        </li>
                        <li><strong>성공 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "마커 조회 완료",
  "data": {
    "content": [
      {
        "id": 10,
        "lat": 37.5665,
        "lng": 126.978,
        "description": "공원 입구 쓰레기",
        "status": "ACTIVE",
        "createdAt": "2025-08-18T10:12:00",
        "user": {
          "id": 1,
          "name": "홍길동"
        },
        "photos": [
          {
            "id": 101,
            "type": "BEFORE",
            "imagePath": "/images/2025/08/18/uuid1.jpg"
          }
        ]
      }
    ],
    "totalElements": 1,
    "totalPages": 1,
    "currentPage": 0,
    "size": 20
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>빈 목록 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "마커 조회 완료",
  "data": {
    "content": [],
    "totalElements": 0,
    "totalPages": 0,
    "currentPage": 0,
    "size": 20
  }
}</pre>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="endpoint">
                    <span class="method get">GET</span>
                    <div class="url">/markers/{id}</div>
                    <ul>
                        <li><strong>Path Parameters:</strong> <code>id</code> - 마커 ID (number)</li>
                        <li><strong>성공 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "마커 조회 완료",
  "data": {
    "id": 10,
    "lat": 37.5665,
    "lng": 126.978,
    "description": "공원 입구 쓰레기",
    "status": "ACTIVE",
    "createdAt": "2025-08-18T10:12:00",
    "updatedAt": "2025-08-18T10:12:00",
    "user": {
      "id": 1,
      "name": "홍길동",
      "username": "hong123"
    },
    "photos": [
      {
        "id": 101,
        "type": "BEFORE",
        "imagePath": "/images/2025/08/18/uuid1.jpg",
        "verificationStatus": "PENDING",
        "createdAt": "2025-08-18T10:12:00"
      }
    ]
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (404) - 마커 없음:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "해당 마커를 찾을 수 없습니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="endpoint">
                    <span class="method get">GET</span>
                    <div class="url">/markers/user/{userId}</div>
                    <ul>
                        <li><strong>Path Parameters:</strong> <code>userId</code> - 사용자 ID (number)</li>
                        <li><strong>성공 응답 (200):</strong> <code>MarkerResponseDTO[]</code> 배열</li>
                        <li><strong>실패 응답 (404) - 사용자 없음:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "해당 사용자를 찾을 수 없습니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="endpoint">
                    <span class="method delete">DELETE</span>
                    <div class="url">/markers/{id}</div>
                    <ul>
                        <li><strong>Header:</strong> <code>Authorization: Bearer {JWT}</code></li>
                        <li><strong>Path Parameters:</strong> <code>id</code> - 마커 ID (number)</li>
                        <li><strong>성공 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "마커와 연결된 모든 사진이 완전히 삭제되었습니다.",
  "data": {
    "deleted_marker_id": 10,
    "deleted_photos_count": 3,
    "deleted_files_count": 3
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (403) - 권한 없음:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "해당 마커를 삭제할 권한이 없습니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (404) - 마커 없음:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "해당 마커를 찾을 수 없습니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>주의사항:</strong>
                            <ul>
                                <li>마커 삭제 시 연결된 모든 사진과 파일이 완전히 삭제됩니다</li>
                                <li>삭제된 데이터는 복구할 수 없습니다</li>
                                <li>본인이 등록한 마커만 삭제 가능합니다</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>📸 3) 사진 관리</h2>
                
                <div class="endpoint">
                    <span class="method post">POST</span>
                    <div class="url">/photos/upload/cleanup (AFTER 업로드)</div>
                    <ul>
                        <li><strong>Header:</strong> <code>Authorization: Bearer {JWT}</code></li>
                        <li><strong>Body (form-data):</strong>
                            <ul>
                                <li><code>marker_id: number</code> - 마커 ID (필수)</li>
                                <li><code>images: file[]</code> - 청소 완료 사진들 (필수, 최대 5장)</li>
                            </ul>
                        </li>
                        <li><strong>성공 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "청소 인증용 사진 업로드 완료",
  "data": {
    "photo_ids": [201, 202],
    "marker_id": 10,
    "type": "AFTER",
    "count": 2,
    "uploaded_images": [
      "/images/2025/08/18/uuid3.jpg",
      "/images/2025/08/18/uuid4.jpg"
    ],
    "created_at": "2025-08-18T10:20:00"
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (400) - 유효성 검증 실패:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "입력값이 올바르지 않습니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (400) - 중복 업로드:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "이미 청소 인증 사진이 업로드된 마커입니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (404) - 마커 없음:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "해당 마커를 찾을 수 없습니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (400) - 이미지 품질 문제:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "이미지 품질이 기준에 맞지 않습니다.",
  "data": {
    "error": "해상도가 너무 낮습니다. 최소 640x480 이상이어야 합니다."
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>동작 흐름:</strong>
                            <ul>
                                <li>1. 사진 업로드 → 즉시 200 응답</li>
                                <li>2. AI 검증은 비동기로 진행</li>
                                <li>3. 검증 상태는 <code>/ai-verification/status/{markerId}</code>로 조회</li>
                                <li>4. 검증 완료 시 자동으로 포인트 지급</li>
                            </ul>
                        </li>
                        <li><strong>요청 제약사항:</strong>
                            <ul>
                                <li><strong>마커 ID:</strong> 존재하는 마커 ID (number)</li>
                                <li><strong>사진:</strong> jpg/jpeg/png, 100KB~10MB, 최대 5장</li>
                                <li><strong>해상도:</strong> 640x480 ~ 4096x4096</li>
                                <li><strong>중복 제한:</strong> 같은 마커에 AFTER 타입은 한 번만</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="endpoint">
                    <span class="method get">GET</span>
                    <div class="url">/photos/{id}</div>
                    <ul>
                        <li><strong>Path Parameters:</strong> <code>id</code> - 사진 ID (number)</li>
                        <li><strong>성공 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "사진 조회 완료",
  "data": {
    "id": 201,
    "marker_id": 10,
    "user_id": 1,
    "image_path": "/images/2025/08/18/uuid3.jpg",
    "type": "AFTER",
    "verification_status": "PENDING",
    "created_at": "2025-08-18T10:20:00",
    "gpt_response": null,
    "file_size": 2048576,
    "width": 1920,
    "height": 1080
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (404) - 사진 없음:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "해당 사진을 찾을 수 없습니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>응답 필드 설명:</strong>
                            <ul>
                                <li><code>verification_status</code>: PENDING, APPROVED, REJECTED</li>
                                <li><code>gpt_response</code>: AI 검증 결과 (검증 전에는 null)</li>
                                <li><code>file_size</code>: 파일 크기 (bytes)</li>
                                <li><code>width/height</code>: 이미지 해상도</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="endpoint">
                    <span class="method get">GET</span>
                    <div class="url">/photos/marker/{markerId}</div>
                    <ul>
                        <li><strong>Path Parameters:</strong> <code>markerId</code> - 마커 ID (number)</li>
                        <li><strong>Query Parameters (선택사항):</strong>
                            <ul>
                                <li><code>type</code> - 사진 타입 필터 (BEFORE, AFTER)</li>
                                <li><code>status</code> - 검증 상태 필터 (PENDING, APPROVED, REJECTED)</li>
                            </ul>
                        </li>
                        <li><strong>성공 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "마커별 사진 조회 완료",
  "data": {
    "marker_id": 10,
    "total_count": 3,
    "before_count": 1,
    "after_count": 2,
    "photos": [
      {
        "id": 101,
        "type": "BEFORE",
        "image_path": "/images/2025/08/18/uuid1.jpg",
        "verification_status": "PENDING",
        "created_at": "2025-08-18T10:10:00",
        "user": {
          "id": 1,
          "name": "홍길동"
        }
      },
      {
        "id": 201,
        "type": "AFTER",
        "image_path": "/images/2025/08/18/uuid3.jpg",
        "verification_status": "APPROVED",
        "created_at": "2025-08-18T10:20:00",
        "user": {
          "id": 1,
          "name": "홍길동"
        },
        "gpt_response": "청소가 완료되었습니다."
      }
    ]
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>빈 목록 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "마커별 사진 조회 완료",
  "data": {
    "marker_id": 10,
    "total_count": 0,
    "before_count": 0,
    "after_count": 0,
    "photos": []
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (404) - 마커 없음:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "해당 마커를 찾을 수 없습니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="section">
                <h2>🤖 4) AI 검증</h2>
                
                <div class="endpoint">
                    <span class="method post">POST</span>
                    <div class="url">/ai-verification/verify/{markerId} (수동 검증)</div>
                    <ul>
                        <li><strong>Path Parameters:</strong> <code>markerId</code> - 마커 ID (number)</li>
                        <li><strong>Header:</strong> <code>Authorization: Bearer {JWT}</code> (선택사항)</li>
                        <li><strong>동작:</strong> 해당 마커의 BEFORE/AFTER 사진을 AI로 검증</li>
                        <li><strong>성공 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "AI 검증이 완료되었습니다.",
  "data": {
    "success": true,
    "verificationResult": "APPROVED",
    "gptResponse": "{\"verification_result\":\"APPROVED\",\"confidence\":0.86,\"reason\":\"청소 전후 사진을 비교한 결과, 쓰레기가 제거되었음을 확인했습니다.\"}",
    "confidence": 0.86,
    "verifiedAt": "2025-08-18T10:21:30",
    "processingTime": 2.5,
    "pointsRewarded": 100
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (400) - 검증 조건 불충족:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "AI 검증을 수행할 수 없습니다.",
  "data": {
    "error": "BEFORE 사진이 없습니다.",
    "requiredPhotos": {
      "before": 0,
      "after": 2
    }
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (400) - 이미 검증 완료:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "이미 검증이 완료된 마커입니다.",
  "data": {
    "currentStatus": "APPROVED",
    "verifiedAt": "2025-08-18T10:15:30"
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (500) - AI 서비스 오류:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "AI 검증 중 오류가 발생했습니다.",
  "data": {
    "error": "OpenAI API 서비스 일시적 장애",
    "retryAfter": "2025-08-18T10:25:00"
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>검증 결과 타입:</strong>
                            <ul>
                                <li><code>APPROVED</code>: 청소 완료 인정 (포인트 100점 지급)</li>
                                <li><code>REJECTED</code>: 청소 미완료 (포인트 미지급)</li>
                                <li><code>PENDING</code>: 검증 대기 중</li>
                            </ul>
                        </li>
                        <li><strong>신뢰도 점수:</strong>
                            <ul>
                                <li><code>0.8~1.0</code>: 매우 높음 (추천)</li>
                                <li><code>0.6~0.79</code>: 높음</li>
                                <li><code>0.4~0.59</code>: 보통</li>
                                <li><code>0.0~0.39</code>: 낮음 (재검증 권장)</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="endpoint">
                    <span class="method get">GET</span>
                    <div class="url">/ai-verification/status/{markerId}</div>
                    <ul>
                        <li><strong>Path Parameters:</strong> <code>markerId</code> - 마커 ID (number)</li>
                        <li><strong>동작:</strong> 마커의 AI 검증 상태 및 사진 정보 조회</li>
                        <li><strong>성공 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "검증 상태 조회 완료",
  "data": {
    "markerId": 10,
    "hasBeforePhotos": true,
    "beforePhotoCount": 1,
    "hasAfterPhotos": true,
    "afterPhotoCount": 2,
    "verificationStatus": "APPROVED",
    "verificationResult": "APPROVED",
    "confidence": 0.86,
    "verifiedAt": "2025-08-18T10:21:30",
    "gptResponse": "{\"verification_result\":\"APPROVED\",\"confidence\":0.86}",
    "pointsRewarded": 100,
    "canVerify": false,
    "verificationProgress": "COMPLETED"
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>검증 대기 중 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "검증 상태 조회 완료",
  "data": {
    "markerId": 10,
    "hasBeforePhotos": true,
    "beforePhotoCount": 1,
    "hasAfterPhotos": true,
    "afterPhotoCount": 2,
    "verificationStatus": "PENDING",
    "verificationResult": null,
    "confidence": null,
    "verifiedAt": null,
    "gptResponse": null,
    "pointsRewarded": 0,
    "canVerify": true,
    "verificationProgress": "READY"
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>검증 불가 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "검증 상태 조회 완료",
  "data": {
    "markerId": 10,
    "hasBeforePhotos": false,
    "beforePhotoCount": 0,
    "hasAfterPhotos": true,
    "afterPhotoCount": 1,
    "verificationStatus": "CANNOT_VERIFY",
    "verificationResult": null,
    "confidence": null,
    "verifiedAt": null,
    "gptResponse": null,
    "pointsRewarded": 0,
    "canVerify": false,
    "verificationProgress": "INSUFFICIENT_PHOTOS",
    "reason": "BEFORE 사진이 필요합니다."
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>실패 응답 (404) - 마커 없음:</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "해당 마커를 찾을 수 없습니다.",
  "data": null
}</pre>
                            </div>
                        </li>
                        <li><strong>응답 필드 설명:</strong>
                            <ul>
                                <li><code>verificationProgress</code>: READY, PROCESSING, COMPLETED, INSUFFICIENT_PHOTOS</li>
                                <li><code>canVerify</code>: 현재 검증 가능 여부 (boolean)</li>
                                <li><code>pointsRewarded</code>: 지급된 포인트 (검증 완료 시에만)</li>
                                <li><code>reason</code>: 검증 불가 이유 (검증 불가 시에만)</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="endpoint">
                    <span class="method get">GET</span>
                    <div class="url">/ai-verification/health</div>
                    <ul>
                        <li><strong>동작:</strong> AI 검증 서비스 상태 확인</li>
                        <li><strong>성공 응답 (200):</strong>
                            <div class="code-block">
<pre>{
  "success": true,
  "message": "AI 검증 서비스 정상 동작 중",
  "data": {
    "status": "HEALTHY",
    "service": "OpenAI GPT-4o",
    "model": "gpt-4o",
    "timestamp": "2025-08-18T10:30:00",
    "pointsReward": 100,
    "minIntervalMinutes": 0,
    "apiKeyConfigured": true,
    "lastVerification": "2025-08-18T10:21:30",
    "totalVerifications": 15,
    "successRate": 0.93
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>서비스 장애 응답 (503):</strong>
                            <div class="code-block">
<pre>{
  "success": false,
  "message": "AI 검증 서비스 일시적 장애",
  "data": {
    "status": "UNHEALTHY",
    "service": "OpenAI GPT-4o",
    "error": "API 키 인증 실패",
    "timestamp": "2025-08-18T10:30:00",
    "retryAfter": "2025-08-18T10:35:00"
  }
}</pre>
                            </div>
                        </li>
                        <li><strong>응답 필드 설명:</strong>
                            <ul>
                                <li><code>status</code>: HEALTHY, UNHEALTHY, MAINTENANCE</li>
                                <li><code>pointsReward</code>: 검증 성공 시 지급 포인트</li>
                                <li><code>minIntervalMinutes</code>: 최소 검증 간격 (0=제한 없음)</li>
                                <li><code>successRate</code>: 최근 검증 성공률 (0.0~1.0)</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="data-structure">
                <h2>📊 데이터 구조 (간단 타입)</h2>
                <ul>
                    <li><strong>MarkerResponseDTO</strong><br>
                        <code>id:number</code>, <code>lat:number</code>, <code>lng:number</code>, <code>description:string</code>, <code>status:"ACTIVE"|"CLEANED"|"REMOVED"</code>, <code>createdAt:string</code>, <code>photos:{id:number,type:"BEFORE"|"AFTER",imagePath:string}[]</code>
                    </li>
                    <li><strong>PhotoResponseDTO</strong><br>
                        <code>id:number</code>, <code>markerId:number</code>, <code>userId:number</code>, <code>imagePath:string</code>, <code>type:"BEFORE"|"AFTER"</code>, <code>verificationStatus:"PENDING"|"APPROVED"|"REJECTED"</code>, <code>gptResponse?:string</code>, <code>createdAt:string</code>
                    </li>
                    <li><strong>GptVerificationResponseDTO</strong><br>
                        <code>success:boolean</code>, <code>verificationResult:"APPROVED"|"REJECTED"</code>, <code>gptResponse:string</code>, <code>confidence:number</code>, <code>errorMessage?:string</code>, <code>verifiedAt:string</code>
                    </li>
                </ul>
            </div>

            <div class="constraints">
                <h2>⚠️ 업로드 제약 (요점)</h2>
                <ul>
                    <li><strong>파일 형식:</strong> 확장자: <code>jpg|jpeg|png</code>, 크기: <code>100KB~10MB</code>, 해상도: <code>640x480~4096x4096</code></li>
                    <li><strong>중복 제한:</strong> AFTER 중복 업로드 제한(같은 마커 동일 타입 재업로드 불가)</li>
                    <li><strong>정적 제공:</strong> <code>/images/**</code></li>
                </ul>
            </div>
        </div>

        <div class="footer">
            <p>🗑️ 함께줍줍(Hamkae) - 안양시 쓰레기 문제 해결을 위한 시민 참여형 플랫폼</p>
            <p>© 2025 멋사 해커톤 3팀</p>
        </div>
    </div>
</body>
</html>
